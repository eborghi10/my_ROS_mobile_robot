<launch>

  <arg name="model" 
  	   default="$(find my_robot_description)/urdf/my_robot.xacro"/>

  <arg name="gui" 
  	   default="true" />

  <arg name="rvizconfig" 
  	   default="$(find my_robot_description)/rviz/my_robot.rviz" />
	
  <!-- necessary to solve NO GUI for joint_state_publisher when using RVIZ   --> 
  <arg name="use_gui" default="true" doc="Should the joint_state_publisher use a GUI for controlling joint states" />

  <!-- ###################################################################### -->

  <!-- 
    Converts the xacro robot information to UDRF and use it as a robot_description parameter
  -->
  <param name="robot_description" 
  		   command="$(find xacro)/xacro $(arg model)" />

  <param name="use_gui" 
  		   value="$(arg gui)"/>

  <!-- ###################################################################### -->

  <!--
    Reads the robot model description, finds all joints, and publishes joint values to all nonfixed joints using GUI sliders. 
  -->
  <node name="joint_state_publisher" 
    		pkg="joint_state_publisher" 
    		type="joint_state_publisher"
			output="screen"
			unless="$(arg use_gui)"	/> <!-- last two lines necessary to solve NO GUI for joint_state_publisher when using RVIZ   -->
  <!-- node necessary to solve NO GUI for joint_state_publisher when using RVIZ   -->		
  <node name="joint_state_publisher_gui" 
    		pkg="joint_state_publisher_gui" 
    		type="joint_state_publisher_gui"
			output="screen"
			if="$(arg use_gui)"	/>


  <!-- 
    Reads the current robot joint states and publishes the 3D poses of each robot link using the kinematics tree build from the URDF. The 3D pose of the robot is published as ROS tf (transform). 
  -->
  <node name="robot_state_publisher" 
    		pkg="robot_state_publisher" 
    		type="robot_state_publisher" />
  <!--  put type="robot_state_publisher", in order to make the robot aprear corectly in RVIz and deal with this type of error message:
	"ERROR: cannot launch node of type [robot_state_publisher/state_publisher]: Cannot locate node of type [state_publisher] in package [robot_state_publisher].
	Make sure file exists in package path and permission is set to executable (chmod +x)"
  -->

  <!-- Show in Rviz -->
  <node name="rviz" 
    		pkg="rviz" 
    		type="rviz" 
    		args="-d $(arg rvizconfig)" 
    		required="false" />

</launch>
